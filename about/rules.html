<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Правила | GusLand</title>
  <link href="/css/style.css" rel="stylesheet" />
</head>
<body>
  <div class="topbar">
    <div class="logo" onclick="window.location.href='/'" style="cursor:pointer;">
      <img src="/images/goose-icon-round.png" alt="Гусь" />
      <span>GusLand</span>
    </div>
    <nav class="topbar-nav">
      <a href="/about/faq.html">О сервере</a>
      <a href="gameplay.html">Геймплей</a>
      <a href="history.html">История сервера</a>
      <a href="updates.html">Обновления</a>
      <a href="https://discord.gg/rwDsBFSJrb" target="_blank">Discord</a>
    </nav>
    <input
      type="text"
      placeholder="Поиск..."
      class="search-input"
      aria-label="Поиск по сайту"
      autocomplete="off"
    />
    <div id="search-results" role="listbox" aria-label="Результаты поиска"></div>
  </div>

  <div class="content-wrapper">
    <aside>
      <nav>
        <a href="guide.html">Гайд для новичков</a>
        <a href="faq.html">Частые вопросы</a>
        <a href="rules.html" class="active">Правила</a>
      </nav>
    </aside>

    <main>
      <h1>Правила сервера</h1>
      <ul>
        <li>Запрещены читы и любые читерские программы.</li>
        <li>Оскорбления и токсичное поведение караются баном.</li>
        <li>Гриферство строго запрещено.</li>
        <li>Запрещена продажа аккаунтов и внутриигровых ресурсов за реальные деньги.</li>
        <li>Соблюдайте уважение к другим игрокам и администрации.</li>
      </ul>
      <p>Нарушение правил ведёт к блокировке доступа к серверу.</p>
    </main>

    <aside class="right-sidebar">
      <h2>Содержание страницы</h2>
      <ul>
        <li><a href="#section1">Запрещённые программы</a></li>
        <li><a href="#section2">Поведение</a></li>
        <li><a href="#section3">Наказания</a></li>
      </ul>
    </aside>
  </div>

  <script>
    const input = document.querySelector('.search-input');
    const results = document.getElementById('search-results');
    let indexData = [];

    fetch('/search-index.json')
      .then(res => res.json())
      .then(data => indexData = data)
      .catch(() => {
        results.innerHTML = '<p style="padding:10px;">Ошибка загрузки данных поиска</p>';
        results.style.display = 'block';
      });

    input.addEventListener('input', () => {
      const query = input.value.trim().toLowerCase();
      results.innerHTML = '';
      results.style.display = 'none';

      if (query.length < 2) return;

      const matches = indexData.filter(item =>
        item.title.toLowerCase().includes(query) ||
        item.content.toLowerCase().includes(query)
      );

      if (matches.length === 0) {
        results.innerHTML = '<p style="padding:10px;">Ничего не найдено</p>';
      } else {
        matches.forEach(match => {
          const snippet = match.content.length > 120 ? match.content.slice(0, 120) + '...' : match.content;
          results.innerHTML += `
            <a href="${match.url}" role="option" class="block p-2 hover:bg-gray-800 rounded">
              <strong style="color:#fde047;">${match.title}</strong><br>
              <span style="font-size:0.9rem; color:#ccc;">${snippet}</span>
            </a>
          `;
        });
      }
      results.style.display = 'block';
    });

    document.addEventListener('click', e => {
      if (!results.contains(e.target) && e.target !== input) {
        results.style.display = 'none';
      }
    });
  </script>
</body>
</html>
